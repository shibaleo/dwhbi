version: 2

seeds:
  # =============================================================================
  # Master Tables (Service Independent)
  # =============================================================================
  - name: mst_time_social_categories
    description: "時間social分類のマスタ（対外的・共有可能な分類）"
    config:
      column_types:
        name: text
        name_ja: text
        description: text
        sort_order: integer
    columns:
      - name: name
        description: "PK, カテゴリ名（VITALS, WORK等）"
        data_tests:
          - unique
          - not_null
      - name: name_ja
        description: "日本語名"
      - name: description
        description: "説明（英語）"
      - name: sort_order
        description: "表示順"

  - name: mst_time_personal_categories
    description: "時間personal分類のマスタ（内省的・個人的分類）"
    config:
      column_types:
        name: text
        name_ja: text
        description: text
        sort_order: integer
        is_day_type_eligible: boolean
    columns:
      - name: name
        description: "PK, カテゴリ名（Sleep, Work等）"
        data_tests:
          - unique
          - not_null
      - name: name_ja
        description: "日本語名"
      - name: description
        description: "説明（英語）"
      - name: sort_order
        description: "表示順"
      - name: is_day_type_eligible
        description: "day_type導出に使用するカテゴリかどうか"

  # =============================================================================
  # Mapping Tables (Service Dependent)
  # =============================================================================
  - name: map_toggl_client_to_time_social
    description: "Toggl clientから時間socialへのマッピング"
    config:
      column_types:
        toggl_client_name: text
        time_category_social: text
    columns:
      - name: toggl_client_name
        description: "PK, Toggl client名"
        data_tests:
          - unique
          - not_null
      - name: time_category_social
        description: "FK → mst_time_social_categories.name"
        data_tests:
          - not_null
          - relationships:
              to: ref('mst_time_social_categories')
              field: name

  - name: map_toggl_color_to_time_personal
    description: "Toggl色から時間personalへのマッピング（API色情報を統合）"
    config:
      column_types:
        toggl_color_hex: text
        toggl_color_name: text
        time_category_personal: text
    columns:
      - name: toggl_color_hex
        description: "PK, Toggl色HEX（#0b83d9等）"
        data_tests:
          - unique
          - not_null
      - name: toggl_color_name
        description: "Toggl色名（Blue等）"
      - name: time_category_personal
        description: "FK → mst_time_personal_categories.name"
        data_tests:
          - not_null
          - relationships:
              to: ref('mst_time_personal_categories')
              field: name

  - name: map_gcal_desc_to_time_social
    description: "Calendar descriptionから時間socialへのマッピング"
    config:
      column_types:
        gcal_description_first_line: text
        time_category_social: text
    columns:
      - name: gcal_description_first_line
        description: "PK, description 1行目"
        data_tests:
          - unique
          - not_null
      - name: time_category_social
        description: "FK → mst_time_social_categories.name"
        data_tests:
          - not_null
          - relationships:
              to: ref('mst_time_social_categories')
              field: name

  - name: map_gcal_color_to_time_personal
    description: "Calendar色から時間personalへのマッピング（API色情報を統合）"
    config:
      column_types:
        gcal_color_id: text
        gcal_color_name: text
        gcal_color_hex: text
        time_category_personal: text
    columns:
      - name: gcal_color_id
        description: "PK, Calendar API色ID（1〜11）"
        data_tests:
          - unique
          - not_null
      - name: gcal_color_name
        description: "色名（Lavender等）"
      - name: gcal_color_hex
        description: "HEX値（参考用）"
      - name: time_category_personal
        description: "FK → mst_time_personal_categories.name"
        data_tests:
          - not_null
          - relationships:
              to: ref('mst_time_personal_categories')
              field: name

  # =============================================================================
  # Target Tables (Goal Management)
  # =============================================================================
  - name: mst_time_target_groups
    description: "目標グループ定義（何を・どの日に・どの方向で達成したいか）"
    config:
      column_types:
        id: integer
        name: text
        time_category_personal: text
        day_type: text
        direction: text
        valid_from: date
        valid_until: date
        description: text
    columns:
      - name: id
        description: "PK"
        data_tests:
          - unique
          - not_null
      - name: name
        description: "グループ識別子（edu_dec, sleep_daily等）"
        data_tests:
          - unique
          - not_null
      - name: time_category_personal
        description: "FK → mst_time_personal_categories.name"
        data_tests:
          - not_null
          - relationships:
              to: ref('mst_time_personal_categories')
              field: name
      - name: day_type
        description: "対象日タイプ（all/Work/Leisure/Education等）"
        data_tests:
          - not_null
          - accepted_values:
              values: ['all', 'Work', 'Leisure', 'Education', 'Rest']
      - name: direction
        description: "達成方向（more=以上, less=以下, neutral=参考値）"
        data_tests:
          - not_null
          - accepted_values:
              values: ['more', 'less', 'neutral']
      - name: valid_from
        description: "有効開始日"
      - name: valid_until
        description: "有効終了日（NULL=無期限）"
      - name: description
        description: "説明"

  - name: mst_time_targets
    description: "目標値（グループに対する具体的な数値目標）"
    config:
      column_types:
        id: integer
        group_id: integer
        version: text
        scope_start: date
        scope_end: date
        target_min: integer
        valid_from: date
        valid_until: date
        description: text
    columns:
      - name: id
        description: "PK"
        data_tests:
          - unique
          - not_null
      - name: group_id
        description: "FK → mst_time_target_groups.id"
        data_tests:
          - not_null
          - relationships:
              to: ref('mst_time_target_groups')
              field: id
      - name: version
        description: "セマンティックバージョン（1.0.0等）"
      - name: scope_start
        description: "目標期間開始"
        data_tests:
          - not_null
      - name: scope_end
        description: "目標期間終了"
        data_tests:
          - not_null
      - name: target_min
        description: "目標時間（分）"
        data_tests:
          - not_null
      - name: valid_from
        description: "この目標値の有効開始日"
      - name: valid_until
        description: "有効終了日（NULL=無期限）"
      - name: description
        description: "説明"
