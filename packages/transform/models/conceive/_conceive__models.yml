# Conceive Layer Models
# =============================================================================
# intent（目標意図）評価モデルのスキーマ定義
#
# intentは「こうなりたい」という目標意図を表現し、
# actualデータに対して達成状況を評価する。
# =============================================================================

version: 2

models:
  - name: intent_sleep_weekly_avg_threshold
    description: |
      週平均睡眠時間の詳細データ（週単位）

      【目標】
      週平均睡眠時間が7時間を下回る週を全体の5%以下に抑える

      【評価期間】
      2025-08-01 ～ 2025-10-31

      【判定基準】（可視化側で実装）
      - 週ごとの平均睡眠時間を計算
      - 7時間（420分）未満の週をカウント
      - 未達週数 / 総週数 <= 5% で達成

      【行動指針】
      - 毎日7時間の睡眠を確保する
      - 睡眠不足の日があっても、週内でリカバリーする
      - 極端な短時間睡眠の日を作らない
    config:
      tags: ['intent', 'sleep', 'weekly']
      meta:
        category: Sleep
        metric: weekly_average_below_threshold
        threshold_min: 420
        failure_rate_limit: 0.05
        period_start: '2025-08-01'
        period_end: '2025-10-31'
        created_by: manual
        created_at: '2025-12-11'
    columns:
      - name: week_start
        description: "週の開始日（月曜日）"
        data_tests:
          - not_null
      - name: week_end
        description: "週の終了日（日曜日）"
        data_tests:
          - not_null
      - name: avg_sleep_min
        description: "週平均睡眠時間（分）"
        data_tests:
          - not_null
      - name: avg_sleep_hours
        description: "週平均睡眠時間（時間）"
        data_tests:
          - not_null
      - name: min_sleep_min
        description: "週内の最小睡眠時間（分）"
        data_tests:
          - not_null
      - name: max_sleep_min
        description: "週内の最大睡眠時間（分）"
        data_tests:
          - not_null
      - name: days_with_data
        description: "データがある日数"
        data_tests:
          - not_null
      - name: threshold_min
        description: "閾値（分）- 参照用"
      - name: threshold_hours
        description: "閾値（時間）- 参照用"
