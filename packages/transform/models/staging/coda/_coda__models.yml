# Coda Staging Models
# =============================================================================
# staging層モデルの定義
# Domain: time (時間管理)
# =============================================================================

version: 2

models:
  # ===========================================================================
  # Time Domain - Intent
  # ===========================================================================
  - name: stg_coda__time_intents
    description: "Time Intent テーブルのstaging層モデル"
    columns:
      - name: intent_id
        description: "Intent unique ID (row_id)"
        data_tests:
          - unique
          - not_null

      - name: description
        description: "Intent description"
        data_tests:
          - not_null

      - name: personal_category
        description: "Personal category name (Work, Leisure, etc.)"

      - name: project
        description: "Project name (Accounting, etc.)"

      - name: hours
        description: "Target hours"
        data_tests:
          - not_null

      - name: unit
        description: "Time unit (day, week)"
        data_tests:
          - not_null
          - accepted_values:
              values: ['day', 'week']

      - name: direction
        description: "Direction (more, less)"
        data_tests:
          - not_null
          - accepted_values:
              values: ['more', 'less']

      - name: is_archived
        description: "Archived flag"
        data_tests:
          - not_null

      - name: notes
        description: "Additional notes"

      - name: synced_at
        description: "Last sync timestamp"
        data_tests:
          - not_null

  # ===========================================================================
  # Time Domain - Categories
  # ===========================================================================
  - name: stg_coda__time_category_personal
    description: "Personal time category master from Coda"
    columns:
      - name: row_id
        description: "Coda row ID"
        data_tests:
          - unique
          - not_null
      - name: name
        description: "Category name (Vitals, Sleep, etc.)"
        data_tests:
          - unique
          - not_null
      - name: name_ja
        description: "Japanese name"
      - name: description
        description: "Description"
      - name: coarse_category
        description: "Coarse category (Essentials, Leisure, Obligation)"
      - name: sort_order
        description: "Sort order"

  - name: stg_coda__time_category_personal_coarse
    description: "Coarse personal time category master from Coda"
    columns:
      - name: row_id
        description: "Coda row ID"
        data_tests:
          - unique
          - not_null
      - name: name
        description: "Coarse category name (Essentials, Leisure, Obligation)"
        data_tests:
          - unique
          - not_null
      - name: sort_order
        description: "Sort order"
      - name: synced_at
        description: "Last sync timestamp"

  - name: stg_coda__time_category_social
    description: "Social time category master from Coda"
    columns:
      - name: row_id
        description: "Coda row ID"
        data_tests:
          - unique
          - not_null
      - name: name
        description: "Category name (PRIMARY, SECONDARY, TERTIARY)"
        data_tests:
          - unique
          - not_null
      - name: name_ja
        description: "Japanese name"
      - name: description
        description: "Description"
      - name: sort_order
        description: "Sort order"

  # ===========================================================================
  # Time Domain - Toggl Mappings
  # ===========================================================================
  - name: stg_coda__time_toggl_color_to_category_personal
    description: "Toggl color to personal time category mapping from Coda"
    columns:
      - name: row_id
        description: "Coda row ID"
        data_tests:
          - unique
          - not_null
      - name: toggl_color_hex
        description: "Toggl color hex code (#0b83d9 etc.)"
        data_tests:
          - unique
          - not_null
      - name: toggl_color_name
        description: "Toggl color name (Blue, Red, etc.)"
      - name: time_category_personal
        description: "Personal time category name (nullable for unmapped colors)"

  - name: stg_coda__time_toggl_client_to_category_social
    description: "Toggl client to social time category mapping from Coda"
    columns:
      - name: row_id
        description: "Coda row ID"
        data_tests:
          - unique
          - not_null
      - name: toggl_client_name
        description: "Toggl client name"
        data_tests:
          - unique
          - not_null
      - name: time_category_social
        description: "Social time category name"
        data_tests:
          - not_null

  # ===========================================================================
  # Time Domain - Toggl Projects Metadata
  # ===========================================================================
  - name: stg_coda__time_toggl_projects
    description: "Toggl project metadata from Coda (sort_order, name_ja)"
    columns:
      - name: row_id
        description: "Coda row ID"
        data_tests:
          - unique
          - not_null
      - name: toggl_project_id
        description: "Toggl project ID"
        data_tests:
          - unique
          - not_null
      - name: name_ja
        description: "Japanese name"
      - name: description
        description: "Description"
      - name: sort_order
        description: "Sort order"
      - name: synced_at
        description: "Last sync timestamp"
